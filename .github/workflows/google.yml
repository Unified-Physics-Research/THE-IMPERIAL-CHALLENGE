name: Subtree Merge LUFT Nodes

on:
  workflow_dispatch:

jobs:
  clone-and-merge:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout LUFT-Unified-Field-Project
        uses: actions/checkout@v4
        with:
          repository: CarlDeanClineSr/LUFT-Unified-Field-Project
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Clone sibling repositories
        run: |
          git clone https://github.com/CarlDeanClineSr/Lattice-Unified-Field-Theory-L.U.F.T.git
          git clone https://github.com/CarlDeanClineSr/Chronological-Craft-Inventions-LUFT.git
          git clone https://github.com/CarlDeanClineSr/CarlDean-ClineSr2.git

      - name: Add remotes and perform subtrees
        run: |
          cd LUFT-Unified-Field-Project

          git remote add luft-theory ../Lattice-Unified-Field-Theory-L.U.F.T
          git fetch luft-theory
          git subtree add --prefix=research luft-theory main --squash || echo "research already exists"

          git remote add luft-craft ../Chronological-Craft-Inventions-LUFT
          git fetch luft-craft
          git subtree add --prefix=notebooks luft-craft main --squash || echo "notebooks already exists"

          git remote add luft-experiments ../CarlDean-ClineSr2
          git fetch luft-experiments
          git subtree add --prefix=experimental luft-experiments main --squash || echo "experimental already exists"

      - name: Prepare data folders
        run: |
          cd LUFT-Unified-Field-Project
          mkdir -p docs src data notebooks research experimental

      - name: Move files
        run: |
          cd LUFT-Unified-Field-Project
          # Example: move files as needed
          # mv research/*.* research/
